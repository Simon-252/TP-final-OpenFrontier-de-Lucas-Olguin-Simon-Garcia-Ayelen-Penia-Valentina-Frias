<script>
    // PASO ID.
    const PASO_ID = '75c05ec9-3ffe-496e-8b0f-ed000f4e6c3a'; 

    // Simplificamos getDayName al m√°ximo para evitar fallos de Date/Locale
    function getDayName(dateString) {
        try {
            const date = new Date(dateString + 'T12:00:00'); 
            return date.toLocaleDateString('es-ES', { weekday: 'long' });
        } catch (e) {
            console.error("Error en getDayName:", e);
            return "D√≠a Error";
        }
    }

    // Simplificamos createWeatherCard al m√°ximo
    function createWeatherCard(data) {
        try {
            const dayName = getDayName(data.fecha_pronostico).replace(/^(.)/, (match) => match.toUpperCase());
            return `<div class="weather-card"><h3 class="day-title">${dayName}</h3><p>Renderizado OK</p></div>`;
        } catch (e) {
            console.error("Error en createWeatherCard:", e);
            return `<div>Error al crear tarjeta</div>`;
        }
    }

    // Funci√≥n de Fetch
    async function fetchWeatherForecast() {
        console.log("üî• Ejecutando fetch desde el layout."); 
        const wrapper = document.getElementById('weather-cards-display');
        
        if (!wrapper) {
            console.error("‚õî ERROR: Contenedor 'weather-cards-display' no encontrado. (Revisa el ID en clima.html)"); 
            return;
        }

        try {
            const response = await fetch(`/api/clima/pronostico/${PASO_ID}`); 
            const forecastData = await response.json();
            
            if (response.ok && forecastData && forecastData.length > 0) {
                const cardsHtml = forecastData.map(createWeatherCard).join('');
                wrapper.innerHTML = cardsHtml;
            } else {
                 wrapper.innerHTML = '<p>No hay pron√≥sticos disponibles (404 o lista vac√≠a).</p>';
            }
            
        } catch (error) {
            console.error('‚õî FATAL ERROR:', error);
            wrapper.innerHTML = '<p>Ocurri√≥ un error al cargar el clima. Intente m√°s tarde.</p>';
        }
    }

    // Llama a la funci√≥n DESPU√âS de un peque√±o retardo para asegurar que el DOM cargue
    setTimeout(fetchWeatherForecast, 100); 

</script>
</body>